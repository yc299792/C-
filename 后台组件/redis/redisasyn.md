### Redis异步处理

在使用hiredis进行编程时，比较常用的就是使用同步的方式，就是发送一条指令，然后等待结果，这样的操作如果很频繁的话就会造成程序执行比较缓慢，走走停停的感觉。所以这里我们想想能不能使用异步执行命令的方式，hiredis为我们提供了一套异步的接口。

### 异步的思想：

所谓异步就是把一些耗时的操作单独开一个线程或者进程去执行，通过这样的方式，主程序就不用去等待执行，所以就会提升速度，但其实就是把这样的操作交给另外的worker做。这就是异步的思想。

那么对于执行命令来说：

- 第一我们需要把这个命令发送给redis，所以需要一个发送的动作。
- 第二，redis执行完了以后需要通知我们执行的结果，我们需要对这个结果进行处理，由于是异步的，所以我们可以想到Reactor模式，即回调。

那么我们现在只要这么做：

- 主程序把需要执行的命令发出去，发给谁，发给专门负则执行命令的异步框架，然后主程序就去继续自己的事情，这就好比，我有一堆活要做，我分一些给别人来做。
- 然后worker现在要做的就是把命令发布给redis指定结果处理函数，然后等到redis执行完成后，会回调处理结果的函数。

这样就实现了异步执行命令的操作，其实这种思想没有同步简单粗暴，同步就是一个正常思维，我先干啥在干啥，比如先执行命令再处理结果，而异步就是，我把命令发出去执行，至于啥时候结束，你通知我，也就是回调函数，所以结果都放在回调函数里面处理。



这段代码：

- 第一部分：模拟异步执行set-key-value，统计执行test——cmd——count次的时间。
- 第二部分：一个生产者消费者模型，先执行生产者，然后通知消费者消费，redis异步消息队列就是这样的一个操作。

这里只是模拟使用hiredis异步处理，测试性能。

真正的异步应该是把这个做成一个异步处理框架，也就是一个worker，然后收到来自别人执行的命令，去执行，然后，回调执行结果的处理函数。
